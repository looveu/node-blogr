window.formData={};Highcharts.seriesTypes.area.prototype.drawLegendSymbol=Highcharts.seriesTypes.line.prototype.drawLegendSymbol;Highcharts.seriesTypes.ohlc.prototype.drawLegendSymbol=Highcharts.seriesTypes.line.prototype.drawLegendSymbol;Highcharts.seriesTypes.candlestick.prototype.drawLegendSymbol=Highcharts.seriesTypes.line.prototype.drawLegendSymbol;
Highcharts.dateFormats={W:function(a){a=new Date(a);var b=0==a.getUTCDay()?7:a.getUTCDay();a.setDate(a.getUTCDate()+4-b);a=Math.floor((a.getTime()-new Date(a.getUTCFullYear(),0,1,-6))/864E5);return 1+Math.floor(a/7)}};
$(document).ready(function(){var a=$(".select-exchanges :checked");formData.exchanges||0!=$(".select-exchanges select").length||(formData.exchanges=[],a.each(function(){formData.exchanges.push($(this).val())}));formData.benchmarks||(formData.benchmarks=[]);formData.smaverage||(formData.smaverage=[]);try{$("#chartfooter .history-download a").colorbox({iframe:!0,width:390,height:480,initialWidth:100,initialHeight:100})}catch(b){}$("a.range-link").live("click",function(){chart.showLoading();var a=$("#tr_beg, #tr_end");
0<a.length&&(a.val(""),delete formData.rangeBegin,delete formData.rangeUntil);formData.selectedRange=$(this).attr("data-range");updateChart();$("#range-selector .active").removeClass("active");$(this).parent().addClass("active");return!1});$("#shownews").live("click",function(){chart.showLoading();$(this).is(":checked")?formData.showNews=1:formData.showNews=0;updateChart()});$(".select-newstype select").live("change",function(){formData.newsTypes=$(this).val();updateChart()});$(".select-charttype select").live("change",
function(){chart.showLoading();var a=$(this).val();"1D"!=$("#range-selector li.active a").attr("data-range")||"ohlc"!=a&&"candlestick"!=a?(formData.chartType=a,updateChart()):(formData.chartType=a,chart.hideLoading())});$(".select-volume select").live("change",function(){chart.showLoading();1==$(this).val()?formData.disableVolume=0:formData.disableVolume=1;updateChart()});$(".select-volume :radio").live("change",function(){chart.showLoading();1==$(this).val()?formData.disableVolume=0:formData.disableVolume=
1;updateChart()});$(".select-exchanges select").live("change",function(){chart.showLoading();var a=$(this).val();formData.exchange=a;updateChart()});$(".select-exchanges :radio").live("change",function(){chart.showLoading();var a=$(this).val();formData.exchange=a;updateChart()});$(".benchmark-select").live("change",function(){0!=$(this).val()&&0<select_benchmark_max&&select_benchmark_max<=formData.benchmarks.length?(alert(select_benchmarks_max_jserror),$(this).find("option:first").attr("selected",
!0)):(updateBenchmarks(),$(document).trigger("updateBottomTable"))});$(".benchmark-checkbox :checkbox").live("change",function(){$(this).is(":checked")&&0<select_benchmark_max&&select_benchmark_max<=formData.benchmarks.length?(alert(select_benchmarks_max_jserror),$(this).attr("checked",!1)):(updateBenchmarks(),$(document).trigger("updateBottomTable"))});$(".smaverage-select").live("change",function(){updateSMAverage()});$(".smaverage-radio :radio").live("change",function(){updateSMAverage()});$(".smaverage-radio label").live("click",
function(){var a=$("#"+$(this).attr("for"));a.is(":checked")?a.removeAttr("checked"):a.attr("checked","checked");updateSMAverage()});$(".select-performance select").live("change",function(){chart.showLoading();"on"==$(this).val()?formData.performance=!0:formData.performance=!1;updateChart()});$(".performance-radio :radio").live("click",function(){chart.showLoading();"on"==$(this).val()?formData.performance=1:formData.performance=0;updateChart()})});
function loadTimeZoneOffset(){var a=new Date,b=a.getTimezoneOffset()/60*-1;a.dst()||(b+=a.stdTimezoneOffset()/60);formData.tz_offset=b}function updateChart(a){window.xhr&&window.xhr.abort();a||(a="ajax");loadTimeZoneOffset();formData.template=void 0;window.xhr=$.ajax({url:"/"+a+"/"+companyName+"/"+language+"/",dataType:"script",data:formData,cache:!1,complete:function(){window.xhr=null}})}
function loadTemplate(a,b){loadTimeZoneOffset();formData.template=a;$.ajax({url:"/tpl/"+companyName+"/"+language+"/",dataType:"html",data:formData,cache:!1,context:$(b)}).done(function(a){$(this).html(a)})}
function updateBenchmarks(){chart.showLoading();formData.benchmarks=[];$(".benchmark-select").each(function(){var a=$(this).val();0!=a&&formData.benchmarks.push(a)});$(".benchmark-checkbox :checkbox").filter(":checked").each(function(){var a=$(this).val();formData.benchmarks.push(a)});updateChart();$(".benchmark-checkbox").filter(":checkbox").not(":checked").attr("disabled",select_benchmark_max<=formData.benchmarks.length)}
function updateSMAverage(){chart.showLoading();formData.smaverage=[];$(".smaverage-select").each(function(){var a=$(this).val();if(0!=a){var b=$(this).parent().attr("class");formData.smaverage.push(b+"|"+a)}});$(".smaverage-radio.active").removeClass("active");$(".smaverage-radio input").filter(":checked").each(function(){$(this).parent().addClass("active");var a=$(this).val();if(0!=a){var b=$(this).parent().parent().attr("class");formData.smaverage.push(b+"|"+a)}});updateChart()}
function chartReloadTrigger(){$(".legend-item").not(".legend-main").hide();$(".benchmark-select").each(function(){var a=$(this).val();0!=a&&$(".legend-"+a).show()});$(".benchmark-checkbox :checkbox").filter(":checked").each(function(){var a=$(this).val();$(".legend-"+a).show()});$(".smaverage-select").each(function(){0!=$(this).val()&&$(".legend-"+$(this).parent().attr("class")).show()});$(".smaverage-radio input").filter(":checked").each(function(){0!=$(this).val()&&$(".legend-"+$(this).parent().parent().attr("class")).show()})}
Date.prototype.stdTimezoneOffset=function(){var a=new Date(this.getFullYear(),0,1),b=new Date(this.getFullYear(),6,1);return a.getTimezoneOffset()!=b.getTimezoneOffset()?Math.max(a.getTimezoneOffset(),b.getTimezoneOffset()):0};Date.prototype.dst=function(){return this.getTimezoneOffset()<this.stdTimezoneOffset()};
